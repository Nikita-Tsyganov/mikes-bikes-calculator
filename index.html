<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="Description" content="Mike's Bikes Utilities" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#FFFFFF" />
    <meta charset="utf-8" />
    <title>Mike's Bikes Utilities</title>
    <link rel="stylesheet" type="text/css" href="bulma.min.css" />
    <style type="text/css">
      .mb-1 {
        margin-bottom: 5px !important;
      }
      .mb-2 {
        margin-bottom: 10px !important;
      }
      .mb-3 {
        margin-bottom: 15px !important;
      }
      .mb-4 {
        margin-bottom: 20px !important;
      }
      .text-bold {
        font-weight: 600;
      }
      .content {
        padding: 20px;
      }
      .label {
        font-weight: 600;
      }
      .help.help.help {
        margin: 2px 0 7.5px 0;
      }
    </style>
  </head>
  <body>
    <div class="content">
      <div class="field">
        <label class="label">Choose segment:</label>
        <div class="control is-marginless">
          <div class="select">
            <select id="segment">
              <option value="none">No segment</option>
              <option value="road">Road</option>
              <option value="mountain">Mountain</option>
              <option value="youth">Youth</option>
            </select>
          </div>
        </div>
      </div>

      <div class="mb-4">
        Input the amount of money you want to allocate for each channel
        <br />
        Minimum amount is 0
        <br />
        Maximum amount is 2800000
        <br />
        Minimal acceptable step is 50000
        <br />
        <p class="help">
          *Efficiency refers to how much coverage you get per $50000 of your
          investment
        </p>
      </div>

      <label class="label">TV:</label>
      <div class="field has-addons is-marginless">
        <p class="control is-marginless">
          <a class="button is-static">
            $
          </a>
        </p>
        <p class="control is-marginless">
          <input
            id="tv"
            type="number"
            min="0"
            max="2800000"
            step="50000"
            name="tv"
            value="0"
            class="input"
          />
        </p>
      </div>
      <p class="help">Peak efficiency is at $1200000</p>
      <div class="mb-4">
        <div id="tvCoverage"></div>
        <div id="tvEff"></div>
      </div>

      <label class="label">Internet:</label>
      <div class="field has-addons is-marginless">
        <p class="control is-marginless">
          <a class="button is-static">
            $
          </a>
        </p>
        <p class="control is-marginless">
          <input
            id="internet"
            type="number"
            min="0"
            max="2800000"
            step="50000"
            name="internet"
            value="0"
            class="input"
          />
        </p>
      </div>
      <p class="help">Peak efficiency is at $1000000</p>
      <div class="mb-4">
        <div id="internetCoverage"></div>
        <div id="internetEff"></div>
      </div>

      <label class="label">Magazines:</label>
      <div class="field has-addons is-marginless">
        <p class="control is-marginless">
          <a class="button is-static">
            $
          </a>
        </p>
        <p class="control is-marginless">
          <input
            id="magazines"
            type="number"
            min="0"
            max="2800000"
            step="50000"
            name="magazines"
            value="0"
            class="input"
          />
        </p>
      </div>
      <p class="help">Peak efficiency is at $600000</p>
      <div class="mb-4">
        <div id="magazinesCoverage"></div>
        <div id="magazinesEff"></div>
      </div>

      <div class="mb-1 text-bold">Overall stats:</div>
      <div id="budget"></div>
      <div id="coverage"></div>
      <div id="costEfficiency"></div>
    </div>
  </body>
  <script>
    const tvStats = {
      "0": 0,
      "50000": 0.25,
      "100000": 0.5,
      "150000": 0.75,
      "200000": 1,
      "250000": 1.9,
      "300000": 2.8,
      "350000": 3.7,
      "400000": 4.6,
      "450000": 5.95,
      "500000": 7.3,
      "550000": 8.65,
      "600000": 10,
      "650000": 11.55,
      "700000": 13.1,
      "750000": 14.65,
      "800000": 16.2,
      "850000": 17.675,
      "900000": 19.15,
      "950000": 20.625,
      "1000000": 22.1,
      "1050000": 23.375,
      "1100000": 24.65,
      "1150000": 25.925,
      "1200000": 27.2,
      "1250000": 28.25,
      "1300000": 29.3,
      "1350000": 30.35,
      "1400000": 31.4,
      "1450000": 32.225,
      "1500000": 33.05,
      "1550000": 33.875,
      "1600000": 34.7,
      "1650000": 35.375,
      "1700000": 36.05,
      "1750000": 36.725,
      "1800000": 37.4,
      "1850000": 37.925,
      "1900000": 38.45,
      "1950000": 38.975,
      "2000000": 39.5,
      "2050000": 39.925,
      "2100000": 40.35,
      "2150000": 40.775,
      "2200000": 41.2,
      "2250000": 41.525,
      "2300000": 41.85,
      "2350000": 42.175,
      "2400000": 42.5,
      "2450000": 42.775,
      "2500000": 43.05,
      "2550000": 43.325,
      "2600000": 43.6,
      "2650000": 43.825,
      "2700000": 44.05,
      "2750000": 44.275,
      "2800000": 44.5
    };
    const internetStats = {
      "0": 0,
      "50000": 0.275,
      "100000": 0.55,
      "150000": 0.825,
      "200000": 1.1,
      "250000": 2.45,
      "300000": 3.8,
      "350000": 5.15,
      "400000": 6.5,
      "450000": 8.775,
      "500000": 11.05,
      "550000": 13.325,
      "600000": 15.6,
      "650000": 17.95,
      "700000": 20.3,
      "750000": 22.65,
      "800000": 25,
      "850000": 26.85,
      "900000": 28.7,
      "950000": 30.55,
      "1000000": 32.4,
      "1050000": 33.725,
      "1100000": 35.05,
      "1150000": 36.375,
      "1200000": 37.7,
      "1250000": 38.575,
      "1300000": 39.45,
      "1350000": 40.325,
      "1400000": 41.2,
      "1450000": 41.775,
      "1500000": 42.35,
      "1550000": 42.925,
      "1600000": 43.5,
      "1650000": 43.9,
      "1700000": 44.3,
      "1750000": 44.7,
      "1800000": 45.1,
      "1850000": 45.4,
      "1900000": 45.7,
      "1950000": 46,
      "2000000": 46.3,
      "2050000": 46.5,
      "2100000": 46.7,
      "2150000": 46.9,
      "2200000": 47.1,
      "2250000": 47.25,
      "2300000": 47.4,
      "2350000": 47.55,
      "2400000": 47.7,
      "2450000": 47.8,
      "2500000": 47.9,
      "2550000": 48,
      "2600000": 48.1,
      "2650000": 48.2,
      "2700000": 48.3,
      "2750000": 48.4,
      "2800000": 48.5
    };
    const magazinesStats = {
      "0": 0,
      "50000": 0.975,
      "100000": 1.95,
      "150000": 2.925,
      "200000": 3.9,
      "250000": 5.4,
      "300000": 6.9,
      "350000": 8.4,
      "400000": 9.9,
      "450000": 11.35,
      "500000": 12.8,
      "550000": 14.25,
      "600000": 15.7,
      "650000": 16.975,
      "700000": 18.25,
      "750000": 19.525,
      "800000": 20.8,
      "850000": 21.85,
      "900000": 22.9,
      "950000": 23.95,
      "1000000": 25,
      "1050000": 25.875,
      "1100000": 26.75,
      "1150000": 27.625,
      "1200000": 28.5,
      "1250000": 29.2,
      "1300000": 29.9,
      "1350000": 30.6,
      "1400000": 31.3,
      "1450000": 31.875,
      "1500000": 32.45,
      "1550000": 33.025,
      "1600000": 33.6,
      "1650000": 34.075,
      "1700000": 34.55,
      "1750000": 35.025,
      "1800000": 35.5,
      "1850000": 35.9,
      "1900000": 36.3,
      "1950000": 36.7,
      "2000000": 37.1,
      "2050000": 37.45,
      "2100000": 37.8,
      "2150000": 38.15,
      "2200000": 38.5,
      "2250000": 38.775,
      "2300000": 39.05,
      "2350000": 39.325,
      "2400000": 39.6,
      "2450000": 39.85,
      "2500000": 40.1,
      "2550000": 40.35,
      "2600000": 40.6,
      "2650000": 40.8,
      "2700000": 41,
      "2750000": 41.2,
      "2800000": 41.4
    };
    const segments = {
      none: {
        tv: 1,
        internet: 1,
        magazines: 1
      },
      road: {
        tv: 0.1,
        internet: 0.4,
        magazines: 0.6
      },
      mountain: {
        tv: 0.4,
        internet: 0.3,
        magazines: 0.5
      },
      youth: {
        tv: 0.7,
        internet: 0.2,
        magazines: 0.2
      }
    };

    const segmentElement = document.getElementById("segment");
    const tvElement = document.getElementById("tv");
    const internetElement = document.getElementById("internet");
    const magazinesElement = document.getElementById("magazines");
    const budget = document.getElementById("budget");
    const coverageElement = document.getElementById("coverage");
    const costEfficiencyElement = document.getElementById("costEfficiency");
    const tvCoverageElement = document.getElementById("tvCoverage");
    const tvEffElement = document.getElementById("tvEff");
    const interneCoverageElement = document.getElementById("internetCoverage");
    const internetEffElement = document.getElementById("internetEff");
    const magazinesCoverageElement = document.getElementById(
      "magazinesCoverage"
    );
    const magazinesEffElement = document.getElementById("magazinesEff");

    window.addEventListener("load", calculate);
    segmentElement.addEventListener("input", calculate);
    tvElement.addEventListener("input", calculate);
    internetElement.addEventListener("input", calculate);
    magazinesElement.addEventListener("input", calculate);

    function calculate(e) {
      let segment = segmentElement.value;

      let tvValue = parseFloat(tvElement.value);
      let internetValue = parseFloat(internetElement.value);
      let magazinesValue = parseFloat(magazinesElement.value);

      if (tvValue !== 0 && tvValue % 50000 > 0) {
        tvValue -= tvValue % 50000;
      }
      if (internetValue !== 0 && internetValue % 50000 > 0) {
        internetValue -= internetValue % 50000;
      }
      if (magazinesValue !== 0 && magazinesValue % 50000 > 0) {
        magazinesValue -= magazinesValue % 50000;
      }

      let tvPercentage = tvStats[tvValue] * segments[segment]["tv"];
      let internetPercentage =
        internetStats[internetValue] * segments[segment]["internet"];
      let magazinesPercentage =
        magazinesStats[magazinesValue] * segments[segment]["magazines"];

      tvCoverageElement.innerHTML = "Covers " + tvPercentage.toFixed(2) + "%";
      interneCoverageElement.innerHTML =
        "Covers " + internetPercentage.toFixed(2) + "%";
      magazinesCoverageElement.innerHTML =
        "Covers " + magazinesPercentage.toFixed(2) + "%";

      let tvCostEfficiency = ((tvPercentage / tvValue || 0) * 50000).toFixed(4);
      let internetCostEfficiency = (
        (internetPercentage / internetValue || 0) * 50000
      ).toFixed(4);
      let magazinesCostEfficiency = (
        (magazinesPercentage / magazinesValue || 0) * 50000
      ).toFixed(4);

      tvEffElement.innerHTML = "Efficiency: " + tvCostEfficiency + "%";
      internetEffElement.innerHTML =
        "Efficiency: " + internetCostEfficiency + "%";
      magazinesEffElement.innerHTML =
        "Efficiency: " + magazinesCostEfficiency + "%";

      let budgetValue = tvValue + internetValue + magazinesValue;
      let coverage = (
        tvPercentage +
        internetPercentage +
        magazinesPercentage
      ).toFixed(2);
      let costEfficiency = ((coverage / budgetValue || 0) * 50000).toFixed(4);

      budget.innerHTML = "Budget: $" + budgetValue;
      coverageElement.innerHTML = "Coverage of the segment: " + coverage;
      costEfficiencyElement.innerHTML = "Efficiency: " + costEfficiency + "%";
    }

    function addStep(object) {
      let counter = 0;
      let prevKey = "0";
      Object.keys(object).forEach(key => {
        counter++;
        if (key === "0") {
          return;
        }
        if (counter >= 2) {
          let newKey = ((parseInt(prevKey) + parseInt(key)) / 2).toString();
          let newVal = parseFloat(
            ((object[prevKey] + object[key]) / 2).toFixed(3)
          );
          object[newKey] = newVal;
        }
        prevKey = key;
      });
      console.log(object);
    }
  </script>
</html>
